<!DOCTYPE html>
<html>
<head>
	<title>jscolor Example</title>
	<link rel="stylesheet" href="./main.css">
</head>
<body style="text-align:center;">



	<script src="jscolor.js"></script>



	<!-- <h2>Example 1</h2>
	Color: <input class="jscolor" value="ab2567">



	<h2>Example 2</h2>

	<button class="jscolor {valueElement:'chosen-value', onFineChange:'setTextColor(this)'}">
		Pick text color
	</button>

	HEX value: <input id="chosen-value" value="000000">

	<script>
	function setTextColor(picker) {
		document.getElementsByTagName('body')[0].style.color = '#' + picker.toString()
	}
	</script>



	<p style="margin-top:3em;">Check out <a href="http://jscolor.com/examples/">more examples at jscolor.com</a>!</p> -->

	<div id="demo-app">

		<script src="release/latest/jscolor.js"></script>


		<div class="panel bgcolor">
			<button id="bgcolor-button" style="background-image: none; background-color: rgb(171, 142, 101); color: rgb(0, 0, 0);" class="">Choose dark mode color</button>
			<table>
				<tbody><tr><th>RGB</th><td><input id="bgcolor-rgb" onchange="setString('bgcolor', this.value); updateAll()"></td></tr>
				<tr><th>HEX</th><td><input id="bgcolor-hex" onchange="setString('bgcolor', this.value); updateAll()"></td></tr>

				<tr><th>H</th><td><input id="bgcolor-hue" class="short" onchange="setHSV('bgcolor', this.value, null, null); updateAll()"> °</td></tr>
				<tr><th>S</th><td><input id="bgcolor-sat" class="short" onchange="setHSV('bgcolor', null, this.value, null); updateAll()"> %</td></tr>
				<tr><th>V</th><td><input id="bgcolor-val" class="short" onchange="setHSV('bgcolor', null, null, this.value); updateAll()"> %</td></tr>

				<tr class="red"><th>R</th><td><input id="bgcolor-red" class="short" onchange="setRGB('bgcolor', this.value, null, null); updateAll()"></td></tr>
				<tr class="grn"><th>G</th><td><input id="bgcolor-grn" class="short" onchange="setRGB('bgcolor', null, this.value, null); updateAll()"></td></tr>
				<tr class="blu"><th>B</th><td><input id="bgcolor-blu" class="short" onchange="setRGB('bgcolor', null, null, this.value); updateAll()"></td></tr>
			</tbody></table>
		</div>

		<div class="panel textcolor">
			<button id="textcolor-button" style="background-image: none; background-color: rgb(171, 142, 101); color: rgb(0, 0, 0);" class="">Choose text/emoji color</button>
			<table>
				<tbody><tr><th>RGB</th><td><input id="textcolor-rgb" onchange="setString('textcolor', this.value); updateAll()"></td></tr>
				<tr><th>HEX</th><td><input id="textcolor-hex" onchange="setString('textcolor', this.value); updateAll()"></td></tr>

				<tr><th>H</th><td><input id="textcolor-hue" class="short" onchange="setHSV('textcolor', this.value, null, null); updateAll()"> °</td></tr>
				<tr><th>S</th><td><input id="textcolor-sat" class="short" onchange="setHSV('textcolor', null, this.value, null); updateAll()"> %</td></tr>
				<tr><th>V</th><td><input id="textcolor-val" class="short" onchange="setHSV('textcolor', null, null, this.value); updateAll()"> %</td></tr>

				<tr class="red"><th>R</th><td><input id="textcolor-red" class="short" onchange="setRGB('textcolor', this.value, null, null); updateAll()"></td></tr>
				<tr class="grn"><th>G</th><td><input id="textcolor-grn" class="short" onchange="setRGB('textcolor', null, this.value, null); updateAll()"></td></tr>
				<tr class="blu"><th>B</th><td><input id="textcolor-blu" class="short" onchange="setRGB('textcolor', null, null, this.value); updateAll()"></td></tr>
			</tbody></table>
		</div>


		<div class="panel fgcolor">
			<button id="fgcolor-button" style="background-image: none; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">Choose light mode color</button>
			<table>
				<tbody><tr><th>RGB</th><td><input id="fgcolor-rgb" onchange="setString('fgcolor', this.value); updateAll()"></td></tr>
				<tr><th>HEX</th><td><input id="fgcolor-hex" onchange="setString('fgcolor', this.value); updateAll()"></td></tr>

				<tr><th>H</th><td><input id="fgcolor-hue" class="short" onchange="setHSV('fgcolor', this.value, null, null); updateAll()"> °</td></tr>
				<tr><th>S</th><td><input id="fgcolor-sat" class="short" onchange="setHSV('fgcolor', null, this.value, null); updateAll()"> %</td></tr>
				<tr><th>V</th><td><input id="fgcolor-val" class="short" onchange="setHSV('fgcolor', null, null, this.value); updateAll()"> %</td></tr>

				<tr class="red"><th>R</th><td><input id="fgcolor-red" class="short" onchange="setRGB('fgcolor', this.value, null, null); updateAll()"></td></tr>
				<tr class="grn"><th>G</th><td><input id="fgcolor-grn" class="short" onchange="setRGB('fgcolor', null, this.value, null); updateAll()"></td></tr>
				<tr class="blu"><th>B</th><td><input id="fgcolor-blu" class="short" onchange="setRGB('fgcolor', null, null, this.value); updateAll()"></td></tr>
			</tbody></table>
		</div>

		<div id="intro">See <a href="https://github.com/aopal/slack-contrast/blob/master/Readme.md">here</a> for usage</div>

		<div id="left" class="sample">
			<div>Lorem ipsum</div>
			<div class="bold">Lorem ipsum</div>
			<div class="italic">Lorem ipsum</div>
			<div id="bgcolor-cntrst">Contrast: </div>
			<div id="bgcolor-min">Contrast: </div>
			<div id="bgcolor-en">Contrast: </div>
		</div>
		<div id="right" class="sample">
			<div>Lorem ipsum</div>
			<div class="bold">Lorem ipsum</div>
			<div class="italic">Lorem ipsum</div>
			<div id="fgcolor-cntrst">Contrast: </div>
			<div id="fgcolor-min">Contrast: </div>
			<div id="fgcolor-en">Contrast: </div>
		</div>


		<script>
		var options = {
			valueElement: null,
			width: 300,
			height: 120,
			sliderSize: 20,
			position: 'top',
			borderColor: '#CCC',
			insetColor: '#CCC',
			backgroundColor: '#202020'
		};

		var pickers = {};

		pickers.bgcolor = new jscolor('bgcolor-button', options);
		pickers.bgcolor.onFineChange = "update('bgcolor')";
		pickers.bgcolor.fromString('1a1d21');

		pickers.fgcolor = new jscolor('fgcolor-button', options);
		pickers.fgcolor.onFineChange = "update('fgcolor')";
		pickers.fgcolor.fromString('FFFFFF');

		pickers.textcolor = new jscolor('textcolor-button', options);
		pickers.textcolor.onFineChange = "updateAll()";
		pickers.textcolor.fromString('00aeef');

		function calculateL(r,g,b) {
			var R = r
			var G = g
			var B = b

			if(r <= 0.03928){
				R = r/12.92
			} else {
				R = Math.pow(((r+0.055)/1.055), 2.4)
			}
			if(g <= 0.03928){
				G = g/12.92
			} else {
				G = Math.pow(((g+0.055)/1.055), 2.4)
			}
			if(b <= 0.03928){
				B = b/12.92
			} else {
				B = Math.pow(((b+0.055)/1.055), 2.4)
			}

			return 0.2126 * R + 0.7152 * G + 0.0722 * B
		}

		function calculateLFromArray(rgb) {
			var r = Math.round(rgb[0])/255.0;
			var g = Math.round(rgb[1])/255.0;
			var b = Math.round(rgb[2])/255.0;

			return calculateL(r,g,b);
		}

		function getContrast(L,Lt) {
			if (L > Lt){
				return (L + 0.05) / (Lt + 0.05)
			} else {
				return (Lt + 0.05) / (L + 0.05)
			}
		}

		var blackL = calculateL(0,0,0);
		var whiteL = calculateL(1,1,1);

		function decideContrastInfoColor(L,contrast,textString) {
			if ( contrast >= 4.5 ) {
				return textString
			} else {
				var blackContrast = getContrast(L,blackL);
				var whiteContrast = getContrast(L,whiteL);
				if ( blackContrast > 4.5 ) {
					return "#000000";
				} else if ( whiteContrast >= 4.5 ) {
					return "#ffffff"
				} else {
					return textString;
				}
			}
		}

		function update (id) {
			document.getElementById('left').style.backgroundColor =
				pickers.bgcolor.toHEXString();

			document.getElementById('right').style.backgroundColor =
				pickers.fgcolor.toHEXString();

			document.getElementById('left').style.color =
				pickers.textcolor.toHEXString();
			document.getElementById('right').style.color =
				pickers.textcolor.toHEXString();

			document.getElementById(id + '-rgb').value = pickers[id].toRGBString();
			document.getElementById(id + '-hex').value = pickers[id].toHEXString();

			document.getElementById(id + '-hue').value = Math.round(pickers[id].hsv[0]);
			document.getElementById(id + '-sat').value = Math.round(pickers[id].hsv[1]);
			document.getElementById(id + '-val').value = Math.round(pickers[id].hsv[2]);

			document.getElementById(id + '-red').value = Math.round(pickers[id].rgb[0]);
			document.getElementById(id + '-grn').value = Math.round(pickers[id].rgb[1]);
			document.getElementById(id + '-blu').value = Math.round(pickers[id].rgb[2]);

			if(id == "textcolor") {
				return;
			}

			var L = calculateLFromArray(pickers[id].rgb);
			var Lt = calculateLFromArray(pickers['textcolor'].rgb);
			var contrast = getContrast(L,Lt);

			var contrastInfoColor = decideContrastInfoColor( L, contrast, pickers.textcolor.toHEXString() );

			if (L > Lt){
				contrast = (L + 0.05) / (Lt + 0.05)
			} else {
				contrast = (Lt + 0.05) / (L + 0.05)
			}

			rounded = Math.round((contrast * 1000))/1000.0

			min_pass = contrast >= 4.5
			enhanced_pass = contrast >= 7

			document.getElementById(id + '-cntrst').innerHTML = "Contrast: " + rounded;
			document.getElementById(id + '-min').innerHTML = "Passed minimum contrast: " + min_pass;
			document.getElementById(id + '-en').innerHTML = "Passed enhanced contrast: " + enhanced_pass;

			document.getElementById(id + '-cntrst').style.color = contrastInfoColor;
			document.getElementById(id + '-min').style.color = contrastInfoColor;
			document.getElementById(id + '-en').style.color = contrastInfoColor;
		}

		function setHSV (id, h, s, v) {
			pickers[id].fromHSV(h, s, v);
			update(id);
		}

		function setRGB (id, r, g, b) {
			pickers[id].fromRGB(r, g, b);
			update(id);
		}

		function setString (id, str) {
			pickers[id].fromString(str);
			update(id);
		}

		function updateAll() {
			update('bgcolor');
			update('fgcolor');
			update('textcolor');
		}

		update('bgcolor');
		update('fgcolor');
		update('textcolor');
		</script>
	</div>



</body>
</html>
